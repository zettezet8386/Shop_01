<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Shop ƒêi·ªán Tho·∫°i 3D</title>
    <style>
      body {
        margin: 0;
        font-family: "Segoe UI", Arial, sans-serif;
        min-height: 100vh;
        color: #fff;
        overflow-x: hidden;
        background: linear-gradient(-45deg, #232526, #414345, #ffb347, #ff3c00);
        background-size: 400% 400%;
        animation: gradientBG 12s ease infinite;
      }
      @keyframes gradientBG {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }
      header {
        text-align: center;
        font-size: 2.3rem;
        font-weight: bold;
        letter-spacing: 2px;
        color: #ffb347;
        padding: 36px 0 18px 0;
        text-shadow: 0 4px 32px #ffb34755, 0 2px 8px #fff2;
        user-select: none;
        margin-bottom: 48px;
      }
      .product-list {
        position: relative;
        height: 420px;
        perspective: 1200px;
        display: block;
        margin-bottom: 0;
        min-height: 320px;
      }
      .product-card {
        position: absolute;
        top: 50%;
        left: 50%;
        transform-style: preserve-3d;
        transition: transform 0.7s cubic-bezier(0.77, 0, 0.18, 1),
          box-shadow 0.5s, filter 0.5s, opacity 0.5s;
        opacity: 0.96;
        z-index: 1;
        width: 270px;
        margin: -180px 0 0 -135px;
        background: rgba(30, 30, 60, 0.97);
        border-radius: 24px;
        box-shadow: 0 8px 32px #000a, 0 2px 16px #ffb34722;
        padding: 32px 24px 24px 24px;
        text-align: center;
        border: 2px solid transparent;
        cursor: pointer;
        will-change: transform, box-shadow;
        overflow: visible;
      }
      .product-card.inactive {
        filter: blur(2px) brightness(0.7) grayscale(0.4);
        opacity: 0.5;
        z-index: 1;
      }
      .product-card.active,
      .product-card:hover {
        filter: none !important;
        opacity: 1 !important;
        box-shadow: 0 16px 48px #ffb34755, 0 4px 24px #000a;
        border: 2px solid #ffb347;
        z-index: 2;
        transform: scale(1.07) rotateY(10deg) translateY(-12px);
      }
      .product-card::after {
        content: "";
        position: absolute;
        left: 50%;
        bottom: 18px;
        transform: translateX(-50%);
        width: 70%;
        height: 18px;
        border-radius: 50%;
        background: radial-gradient(ellipse at center, #0006 0%, #0000 80%);
        opacity: 0.7;
        z-index: 0;
        transition: filter 0.3s, opacity 0.3s;
        pointer-events: none;
      }
      .product-card:hover::after,
      .product-card.active::after {
        filter: blur(2px) brightness(1.2);
        opacity: 1;
      }
      .product-card img {
        width: 160px;
        height: 160px;
        object-fit: contain;
        border-radius: 18px;
        margin-bottom: 18px;
        background: #fff;
        box-shadow: 0 4px 24px #ffb34733;
        transition: transform 0.4s cubic-bezier(0.77, 0, 0.18, 1),
          box-shadow 0.3s;
        z-index: 1;
        position: relative;
      }
      .product-card:hover img,
      .product-card.active img {
        transform: scale(1.1) rotateY(10deg);
        box-shadow: 0 8px 32px #ffb34755;
      }
      .product-card h3 {
        font-size: 1.2rem;
        margin: 10px 0 6px 0;
        color: #ffb347;
        letter-spacing: 0.5px;
      }
      .price {
        color: #ff3c00;
        font-size: 1.25rem;
        font-weight: bold;
        margin-bottom: 14px;
        text-shadow: 0 2px 8px #ff3c0033;
      }
      .product-card button {
        background: linear-gradient(90deg, #ff3c00 0%, #ffb347 100%);
        color: #fff;
        border: none;
        border-radius: 20px;
        padding: 10px 30px;
        font-size: 1rem;
        cursor: pointer;
        transition: background 0.2s, color 0.2s, transform 0.2s;
        box-shadow: 0 2px 12px #ff3c0033;
        margin-top: 10px;
        font-weight: bold;
        letter-spacing: 1px;
      }
      .product-card button:hover {
        background: linear-gradient(90deg, #fff 0%, #ffb347 100%);
        color: #ff3c00;
        transform: scale(1.08);
      }
      .product-card .highlight {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        border-radius: 24px;
        pointer-events: none;
        background: radial-gradient(
          circle at var(--mx, 50%) var(--my, 50%),
          #fff3 0%,
          #fff0 70%
        );
        opacity: 0.7;
        transition: background 0.2s;
        z-index: 2;
        mix-blend-mode: lighten;
        display: none;
      }
      .product-card:hover .highlight {
        display: block;
      }
      .hex-carousel-controls {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 120px 0 0 0;
      }
      .hex-carousel-controls button {
        background: #232526;
        color: #ffb347;
        border: none;
        border-radius: 50%;
        width: 48px;
        height: 48px;
        font-size: 2rem;
        cursor: pointer;
        box-shadow: 0 2px 8px #ffb34733;
        transition: background 0.2s, color 0.2s, transform 0.2s;
      }
      .hex-carousel-controls button:hover {
        background: #ffb347;
        color: #232526;
        transform: scale(1.1);
      }
      /* Popup chi ti·∫øt s·∫£n ph·∫©m */
      .popup-bg {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.7);
        z-index: 100;
        align-items: center;
        justify-content: center;
      }
      .popup-bg.active {
        display: flex;
      }
      .popup {
        background: #232526;
        border-radius: 24px;
        box-shadow: 0 8px 32px #000a, 0 2px 16px #ffb34722;
        padding: 36px 32px 32px 32px;
        min-width: 320px;
        max-width: 90vw;
        color: #fff;
        position: relative;
        animation: popupIn 0.5s;
      }
      @keyframes popupIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .popup img {
        width: 180px;
        height: 180px;
        object-fit: contain;
        border-radius: 18px;
        background: #fff;
        box-shadow: 0 4px 24px #ffb34733;
        margin-bottom: 18px;
        display: block;
        margin-left: auto;
        margin-right: auto;
      }
      .popup h3 {
        color: #ffb347;
        margin: 12px 0 8px 0;
        text-align: center;
      }
      .popup .price {
        text-align: center;
        margin-bottom: 12px;
      }
      .popup ul {
        margin: 0 0 12px 0;
        padding-left: 20px;
        color: #fff;
        font-size: 1.05rem;
      }
      .popup .close-btn {
        position: absolute;
        top: 12px;
        right: 18px;
        background: #ff3c00;
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        font-size: 1.2rem;
        cursor: pointer;
        box-shadow: 0 2px 8px #ff3c0033;
        transition: background 0.2s;
      }
      .popup .close-btn:hover {
        background: #fff;
        color: #ff3c00;
      }
      footer {
        text-align: center;
        padding: 24px 0 12px 0;
        color: #aaa;
        font-size: 1rem;
        margin-top: 40px;
        letter-spacing: 0.5px;
        z-index: 2;
        user-select: none;
      }
      /* Gi·ªè h√†ng v√† thanh to√°n */
      .cart-bg,
      .checkout-bg {
        display: none;
        position: fixed;
        left: 0;
        top: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.7);
        z-index: 200;
        align-items: center;
        justify-content: center;
      }
      .cart-bg.active,
      .checkout-bg.active {
        display: flex;
      }
      .cart-popup,
      .checkout-popup {
        background: #232526;
        border-radius: 24px;
        box-shadow: 0 8px 32px #000a, 0 2px 16px #ffb34722;
        padding: 36px 32px 32px 32px;
        min-width: 320px;
        max-width: 90vw;
        color: #fff;
        position: relative;
        animation: popupIn 0.5s;
      }
      .cart-popup h3,
      .checkout-popup h3 {
        color: #ffb347;
        margin: 12px 0 18px 0;
        text-align: center;
      }
      .cart-popup ul {
        list-style: none;
        padding: 0;
        margin: 0 0 18px 0;
      }
      .cart-popup li {
        margin-bottom: 8px;
        border-bottom: 1px solid #4443;
        padding-bottom: 6px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .cart-total {
        font-weight: bold;
        color: #ff3c00;
        margin-bottom: 18px;
        text-align: right;
      }
      .checkout-btn,
      .pay-btn {
        background: linear-gradient(90deg, #ff3c00 0%, #ffb347 100%);
        color: #fff;
        border: none;
        border-radius: 20px;
        padding: 10px 30px;
        font-size: 1rem;
        cursor: pointer;
        transition: background 0.2s, color 0.2s, transform 0.2s;
        box-shadow: 0 2px 12px #ff3c0033;
        font-weight: bold;
        letter-spacing: 1px;
        width: 100%;
      }
      .checkout-btn:hover,
      .pay-btn:hover {
        background: linear-gradient(90deg, #fff 0%, #ffb347 100%);
        color: #ff3c00;
        transform: scale(1.04);
      }
      .cart-popup .close-btn,
      .checkout-popup .close-btn {
        position: absolute;
        top: 12px;
        right: 18px;
        background: #ff3c00;
        color: #fff;
        border: none;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        font-size: 1.2rem;
        cursor: pointer;
        box-shadow: 0 2px 8px #ff3c0033;
        transition: background 0.2s;
      }
      .cart-popup .close-btn:hover,
      .checkout-popup .close-btn:hover {
        background: #fff;
        color: #ff3c00;
      }
      @media (max-width: 900px) {
        .product-list {
          flex-direction: column;
          align-items: center;
          height: auto;
          min-height: 0;
        }
        .product-card {
          width: 90vw;
          min-width: 220px;
          max-width: 320px;
          position: static !important;
          margin: 24px auto !important;
          transform: none !important;
        }
        .hex-carousel-controls {
          margin: 16px 0 0 0;
        }
      }
      .cart-float-btn {
        position: fixed;
        top: 28px;
        right: 32px;
        z-index: 300;
        background: #232526;
        color: #ffb347;
        border-radius: 50%;
        width: 56px;
        height: 56px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        box-shadow: 0 4px 24px #000a, 0 2px 8px #ffb34733;
        cursor: pointer;
        transition: background 0.2s, color 0.2s, transform 0.2s;
        border: 2px solid #ffb347;
      }
      .cart-float-btn:hover {
        background: #ffb347;
        color: #232526;
        transform: scale(1.08);
      }
      .cart-count {
        position: absolute;
        top: 8px;
        right: 10px;
        background: #ff3c00;
        color: #fff;
        border-radius: 50%;
        font-size: 1rem;
        font-weight: bold;
        min-width: 22px;
        height: 22px;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 5px;
        box-shadow: 0 2px 8px #ff3c0033;
      }
      @media (max-width: 600px) {
        .cart-float-btn {
          top: 12px;
          right: 10px;
          width: 44px;
          height: 44px;
          font-size: 1.3rem;
        }
        .cart-count {
          top: 2px;
          right: 2px;
          font-size: 0.9rem;
          min-width: 16px;
          height: 16px;
        }
      }
    </style>
  </head>
  <body>
    <header>Shop ƒêi·ªán Tho·∫°i 3D</header>
    <div class="product-list" id="productList"></div>
    <div class="hex-carousel-controls">
      <button id="prevBtn">‚óÄ</button>
      <button id="nextBtn">‚ñ∂</button>
    </div>
    <div class="popup-bg" id="popupBg">
      <div class="popup" id="popup">
        <button class="close-btn" onclick="closePopup()">√ó</button>
        <img id="popupImg" src="" alt="" />
        <h3 id="popupName"></h3>
        <div class="price" id="popupPrice"></div>
        <ul id="popupSpecs"></ul>
      </div>
    </div>
    <div class="cart-bg" id="cartBg">
      <div class="cart-popup">
        <button class="close-btn" onclick="closeCart()">√ó</button>
        <h3>üõí Gi·ªè h√†ng</h3>
        <ul id="cartList"></ul>
        <div class="cart-total">T·ªïng: <span id="cartTotal"></span></div>
        <button class="checkout-btn" onclick="openCheckout()">
          Thanh to√°n
        </button>
      </div>
    </div>
    <div class="checkout-bg" id="checkoutBg">
      <div class="checkout-popup">
        <button class="close-btn" onclick="closeCheckout()">√ó</button>
        <h3>Thanh to√°n</h3>
        <div id="checkoutInfo"></div>
        <div style="margin: 18px 0 10px 0">
          <label style="font-weight: bold">Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n:</label
          ><br />
          <input type="radio" name="payMethod" id="payQR" value="qr" checked />
          <label for="payQR">Qu√©t m√£ QR</label>
          <input
            type="radio"
            name="payMethod"
            id="payBank"
            value="bank"
            style="margin-left: 18px"
          />
          <label for="payBank">ƒêi·ªÅn th√¥ng tin ng√¢n h√†ng</label>
        </div>
        <div
          id="qrSection"
          style="display: block; text-align: center; margin-bottom: 18px"
        >
          <img
            src="https://img.vietqr.io/image/VCB-0123456789-compact2.png"
            alt="QR Code"
            style="
              width: 180px;
              height: 180px;
              border-radius: 16px;
              box-shadow: 0 2px 12px #0004;
            "
          />
          <div style="margin-top: 10px; color: #ffb347; font-weight: bold">
            Qu√©t m√£ QR b·∫±ng app ng√¢n h√†ng ƒë·ªÉ thanh to√°n
          </div>
          <div style="font-size: 0.95rem; color: #ccc; margin-top: 4px">
            N·ªôi dung chuy·ªÉn kho·∫£n:
            <b>ƒê·ªãa ch·ªâ nh·∫≠n h√†ng c·ªßa b·∫°n </b>
          </div>
        </div>
        <div
          style="
            background: #fff2;
            padding: 12px 16px;
            border-radius: 10px;
            margin-bottom: 14px;
            color: #ffb347;
            font-weight: bold;
          "
        >
          <div>
            Ng√¢n h√†ng nh·∫≠n: <span style="color: #ff3c00">Agribank</span>
          </div>
          <div>
            S·ªë t√†i kho·∫£n: <span style="color: #ff3c00">2607281031279</span>
          </div>
          <div>
            Ch·ªß t√†i kho·∫£n: <span style="color: #ff3c00">HOANG DUC TUE</span>
          </div>
        </div>
        <form id="bankForm" style="margin-top: 0; display: none">
          <select
            id="bankName"
            style="
              width: 100%;
              padding: 8px;
              margin-bottom: 10px;
              border-radius: 8px;
              border: 1px solid #ccc;
              font-size: 1rem;
            "
          >
            <option value="">Ch·ªçn ng√¢n h√†ng</option>
            <option value="Vietcombank">Vietcombank</option>
            <option value="VietinBank">VietinBank</option>
            <option value="BIDV">BIDV</option>
            <option value="Techcombank">Techcombank</option>
            <option value="MB Bank">MB Bank</option>
            <option value="Agribank">Agribank</option>
            <option value="ACB">ACB</option>
            <option value="Sacombank">Sacombank</option>
            <option value="TPBank">TPBank</option>
            <option value="VPBank">VPBank</option>
            <option value="SHB">SHB</option>
            <option value="HDBank">HDBank</option>
            <option value="VIB">VIB</option>
            <option value="Eximbank">Eximbank</option>
            <option value="OCB">OCB</option>
            <option value="SeABank">SeABank</option>
            <option value="SCB">SCB</option>
            <option value="LienVietPostBank">LienVietPostBank</option>
            <option value="MSB">MSB</option>
            <option value="PVcomBank">PVcomBank</option>
          </select>
          <input
            type="text"
            id="bankAccount"
            placeholder="S·ªë t√†i kho·∫£n"
            style="
              width: 100%;
              padding: 8px;
              margin-bottom: 10px;
              border-radius: 8px;
              border: 1px solid #ccc;
              font-size: 1rem;
            "
          />
          <input
            type="text"
            id="bankOwner"
            placeholder="Ch·ªß t√†i kho·∫£n"
            style="
              width: 100%;
              padding: 8px;
              margin-bottom: 10px;
              border-radius: 8px;
              border: 1px solid #ccc;
              font-size: 1rem;
            "
          />
          <input
            type="text"
            id="shippingAddress"
            placeholder="N·ªôi dung chuy·ªÉn kho·∫£n: ƒë·ªãa ch·ªâ nh·∫≠n h√†ng c·ªßa b·∫°n"
            style="
              width: 100%;
              padding: 8px;
              margin-bottom: 10px;
              border-radius: 8px;
              border: 1px solid #ccc;
              font-size: 1rem;
            "
          />
        </form>
        <div
          id="bankError"
          style="
            color: #ff3c00;
            font-size: 1rem;
            margin-bottom: 8px;
            display: none;
          "
        ></div>
        <button class="pay-btn" onclick="payOrder()">
          X√°c nh·∫≠n thanh to√°n
        </button>
        <div
          id="reviewSection"
          style="
            margin: 24px 0 16px 0;
            border-top: 1px solid #4443;
            padding-top: 18px;
          "
        >
          <div style="font-weight: bold; margin-bottom: 8px">
            ƒê√°nh gi√° d·ªãch v·ª•:
          </div>
          <div
            id="starRating"
            style="font-size: 2rem; color: #ffb347; margin-bottom: 8px"
          >
            <span class="star" data-star="1">&#9733;</span>
            <span class="star" data-star="2">&#9733;</span>
            <span class="star" data-star="3">&#9733;</span>
            <span class="star" data-star="4">&#9733;</span>
            <span class="star" data-star="5">&#9733;</span>
          </div>
          <textarea
            id="reviewText"
            rows="2"
            style="
              width: 100%;
              border-radius: 8px;
              border: 1px solid #ccc;
              padding: 8px;
              font-size: 1rem;
            "
            placeholder="Nh·∫≠n x√©t c·ªßa b·∫°n..."
          ></textarea>
          <button
            type="button"
            id="sendReviewBtn"
            style="
              margin-top: 10px;
              background: #ffb347;
              color: #232526;
              border: none;
              border-radius: 18px;
              padding: 8px 24px;
              font-weight: bold;
              cursor: pointer;
            "
          >
            G·ª≠i ƒë√°nh gi√°
          </button>
          <div
            id="reviewMsg"
            style="
              color: #ff3c00;
              font-size: 1rem;
              margin-top: 8px;
              display: none;
            "
          ></div>
        </div>
      </div>
    </div>
    <footer>&copy; 2025 Shop ƒêi·ªán Tho·∫°i 3D. All rights reserved.</footer>
    <div id="cartFloatingBtn" class="cart-float-btn" onclick="openCart()">
      üõí
      <span id="cartCount" class="cart-count">0</span>
    </div>
    <script>
      // D·ªØ li·ªáu s·∫£n ph·∫©m
      const products = [
        {
          name: "iPhone 15 Pro Max",
          price: "34.990.000‚Ç´",
          img: "https://tse1.mm.bing.net/th/id/OIP.zdIyAUDNyuBDu7VdROHuMQHaHa?pid=Api&P=0&h=220",
          specs: [
            'M√†n h√¨nh: 6.7" OLED 120Hz',
            "Chip: Apple A17 Pro",
            "RAM: 8GB, ROM: 256GB",
            "Camera: 48MP + 12MP + 12MP",
            "Pin: 4422mAh, S·∫°c nhanh 20W",
          ],
        },
        {
          name: "Samsung S24 Ultra",
          price: "28.990.000‚Ç´",
          img: "https://sp.yimg.com/ib/th?id=OPHS.CzOkqkrp4ZEYqg474C474&o=5&pid=21.1",
          specs: [
            'M√†n h√¨nh: 6.8" Dynamic AMOLED 2X 120Hz',
            "Chip: Snapdragon 8 Gen 3",
            "RAM: 12GB, ROM: 256GB",
            "Camera: 200MP + 12MP + 10MP + 10MP",
            "Pin: 5000mAh, S·∫°c nhanh 45W",
          ],
        },
        {
          name: "Xiaomi 14",
          price: "19.990.000‚Ç´",
          img: "https://tse1.mm.bing.net/th/id/OIP.mEQEvi6Ky3R8-nYCY0sqwAHaIp?pid=Api&P=0&h=220",
          specs: [
            'M√†n h√¨nh: 6.36" AMOLED 120Hz',
            "Chip: Snapdragon 8 Gen 3",
            "RAM: 12GB, ROM: 256GB",
            "Camera: 50MP + 50MP + 50MP",
            "Pin: 4610mAh, S·∫°c nhanh 90W",
          ],
        },
        {
          name: "OPPO Find X7 Ultra",
          price: "22.990.000‚Ç´",
          img: "https://sp.yimg.com/ib/th?id=OPHS.CzOkqkrp4ZEYqg474C474&o=5&pid=21.1",
          specs: [
            'M√†n h√¨nh: 6.82" AMOLED 120Hz',
            "Chip: Snapdragon 8 Gen 3",
            "RAM: 16GB, ROM: 512GB",
            "Camera: 50MP + 50MP + 50MP + 50MP",
            "Pin: 5000mAh, S·∫°c nhanh 100W",
          ],
        },
        {
          name: "Samsung S24 Ultra",
          price: "28.990.000‚Ç´",
          img: "https://tse1.mm.bing.net/th/id/OIP.mEQEvi6Ky3R8-nYCY0sqwAHaIp?pid=Api&P=0&h=220",
          specs: [
            'M√†n h√¨nh: 6.8" Dynamic AMOLED 2X 120Hz',
            "Chip: Snapdragon 8 Gen 3",
            "RAM: 12GB, ROM: 256GB",
            "Camera: 200MP + 12MP + 10MP + 10MP",
            "Pin: 5000mAh, S·∫°c nhanh 45W",
          ],
        },
        {
          name: "Xiaomi 14",
          price: "19.990.000‚Ç´",
          img: "https://tse1.mm.bing.net/th/id/OIP.mEQEvi6Ky3R8-nYCY0sqwAHaIp?pid=Api&P=0&h=220",
          specs: [
            'M√†n h√¨nh: 6.36" AMOLED 120Hz',
            "Chip: Snapdragon 8 Gen 3",
            "RAM: 12GB, ROM: 256GB",
            "Camera: 50MP + 50MP + 50MP",
            "Pin: 4610mAh, S·∫°c nhanh 90W",
          ],
        },
      ];

      const productList = document.getElementById("productList");
      const hexCount = products.length;
      const radius = 330;
      let hexIndex = 0;

      // Render s·∫£n ph·∫©m
      productList.innerHTML = "";
      products.forEach((p, idx) => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
        <span class="highlight"></span>
        <img src="${p.img}" alt="${p.name}" />
        <h3>${p.name}</h3>
        <div class="price">${p.price}</div>
        <button class="buy-btn">Th√™m v√†o gi·ªè h√†ng</button>
        <button class="detail-btn">Xem chi ti·∫øt</button>
      `;
        // Hi·ªáu ·ª©ng highlight √°nh s√°ng ƒë·ªông
        card.addEventListener("mousemove", (e) => {
          const rect = card.getBoundingClientRect();
          const mx = ((e.clientX - rect.left) / rect.width) * 100;
          const my = ((e.clientY - rect.top) / rect.height) * 100;
          card.querySelector(".highlight").style.setProperty("--mx", `${mx}%`);
          card.querySelector(".highlight").style.setProperty("--my", `${my}%`);
        });
        card.querySelector(".detail-btn").onclick = () => openPopup(idx);
        productList.appendChild(card);
      });

      const cards = productList.querySelectorAll(".product-card");

      function renderHexCarousel() {
        for (let i = 0; i < hexCount; i++) {
          // T√≠nh v·ªã tr√≠ tu·∫ßn ho√†n quanh l·ª•c gi√°c, lu√¥n ch·ªçn ƒë∆∞·ªùng ng·∫Øn nh·∫•t
          let rel = (i - hexIndex + hexCount) % hexCount;
          if (rel > hexCount / 2) rel -= hexCount;
          const angle = (rel * 60 * Math.PI) / 180;
          const x = Math.sin(angle) * radius;
          const z = Math.cos(angle) * radius;
          cards[i].style.transform = `
          translateX(${x}px)
          translateZ(${z}px)
          rotateY(${angle}rad)
        `;
          cards[i].classList.remove("active", "inactive");
        }
        // Card ch√≠nh gi·ªØa (·ªü v·ªã tr√≠ 0)
        for (let i = 0; i < hexCount; i++) {
          if (i === ((hexIndex % hexCount) + hexCount) % hexCount) {
            cards[i].classList.add("active");
          } else {
            cards[i].classList.add("inactive");
          }
        }
      }
      renderHexCarousel();

      // N√∫t ƒëi·ªÅu h∆∞·ªõng
      document.getElementById("prevBtn").onclick = () => {
        hexIndex = (hexIndex - 1 + hexCount) % hexCount;
        renderHexCarousel();
      };
      document.getElementById("nextBtn").onclick = () => {
        hexIndex = (hexIndex + 1) % hexCount;
        renderHexCarousel();
      };
      productList.addEventListener("mouseenter", () => {
        autoRotate = false;
      });
      productList.addEventListener("mouseleave", () => {
        autoRotate = true;
      });
      document.getElementById("popupBg").addEventListener("mouseenter", () => {
        autoRotate = false;
      });
      document.getElementById("popupBg").addEventListener("mouseleave", () => {
        autoRotate = true;
      });

      // Popup chi ti·∫øt s·∫£n ph·∫©m
      function openPopup(idx) {
        const p = products[idx];
        document.getElementById("popupImg").src = p.img;
        document.getElementById("popupName").textContent = p.name;
        document.getElementById("popupPrice").textContent = p.price;
        document.getElementById("popupSpecs").innerHTML = p.specs
          .map((s) => `<li>${s}</li>`)
          .join("");
        document.getElementById("popupBg").classList.add("active");
        document.querySelectorAll(".product-card").forEach((c, i) => {
          c.classList.toggle("active", i === idx);
        });
      }
      function closePopup() {
        document.getElementById("popupBg").classList.remove("active");
        document
          .querySelectorAll(".product-card")
          .forEach((c) => c.classList.remove("active"));
      }
      document.getElementById("popupBg").onclick = function (e) {
        if (e.target === this) closePopup();
      };

      // Gi·ªè h√†ng
      let cart = [];

      function openCart() {
        document.getElementById("cartBg").classList.add("active");
      }
      function closeCart() {
        document.getElementById("cartBg").classList.remove("active");
      }

      // Th√™m v√†o gi·ªè h√†ng
      function addToCart(idx) {
        cart.push(products[idx]);
        updateCart();
        openCart();
      }

      // X√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè
      function removeCart(idx) {
        cart.splice(idx, 1);
        updateCart();
      }

      // C·∫≠p nh·∫≠t gi·ªè h√†ng v√† s·ªë l∆∞·ª£ng n·ªïi
      function updateCart() {
        const cartList = document.getElementById("cartList");
        const cartTotal = document.getElementById("cartTotal");
        cartList.innerHTML = "";
        let total = 0;
        cart.forEach((item, idx) => {
          total += parseInt(item.price.replace(/\D/g, ""));
          const li = document.createElement("li");
          li.innerHTML = `
            <span>${item.name}</span>
            <span>${item.price} <button onclick="removeCart(${idx})" style="background:none;border:none;color:#ff3c00;font-size:1.1em;cursor:pointer;">√ó</button></span>
          `;
          cartList.appendChild(li);
        });
        cartTotal.textContent = total.toLocaleString("vi-VN") + "‚Ç´";
        updateCartCount();
      }
      function updateCartCount() {
        document.getElementById("cartCount").textContent = cart.length;
        document.getElementById("cartCount").style.display = cart.length
          ? "flex"
          : "none";
      }
      updateCartCount();

      function openCheckout() {
        if (cart.length === 0) {
          alert("Gi·ªè h√†ng c·ªßa b·∫°n ƒëang tr·ªëng!");
          return;
        }
        document.getElementById("cartBg").classList.remove("active");
        document.getElementById("checkoutBg").classList.add("active");
        let html = "<ul>";
        let total = 0;
        cart.forEach((item) => {
          html += `<li>${item.name} - ${item.price}</li>`;
          total += parseInt(item.price.replace(/\D/g, ""));
        });
        html += "</ul>";
        html += `<div style="color:#ff3c00;font-weight:bold;margin-top:10px;">T·ªïng thanh to√°n: ${total.toLocaleString(
          "vi-VN"
        )}‚Ç´</div>`;
        document.getElementById("checkoutInfo").innerHTML = html;
      }
      function closeCheckout() {
        document.getElementById("checkoutBg").classList.remove("active");
      }

      // Thanh to√°n: ch·ªçn QR ho·∫∑c ng√¢n h√†ng
      document.getElementById("payQR").onchange = function () {
        document.getElementById("qrSection").style.display = "block";
        document.getElementById("bankForm").style.display = "none";
        document.getElementById("bankError").style.display = "none";
      };
      document.getElementById("payBank").onchange = function () {
        document.getElementById("qrSection").style.display = "none";
        document.getElementById("bankForm").style.display = "block";
        document.getElementById("bankError").style.display = "none";
      };

      function payOrder() {
        const method = document.querySelector(
          'input[name="payMethod"]:checked'
        ).value;
        const bankError = document.getElementById("bankError");
        if (method === "qr") {
          bankError.style.display = "none";
          alert(
            "Vui l√≤ng ho√†n t·∫•t chuy·ªÉn kho·∫£n b·∫±ng m√£ QR. ƒê∆°n h√†ng c·ªßa b·∫°n s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω sau khi x√°c nh·∫≠n!"
          );
          cart = [];
          closeCheckout();
          updateCart();
          return;
        }
        // N·∫øu ch·ªçn ƒëi·ªÅn th√¥ng tin ng√¢n h√†ng
        const bankName = document.getElementById("bankName").value;
        const bankAccount = document.getElementById("bankAccount").value.trim();
        const bankOwner = document.getElementById("bankOwner").value.trim();
        const shippingAddress = document
          .getElementById("shippingAddress")
          .value.trim();
        if (!bankName || !bankAccount || !bankOwner || !shippingAddress) {
          bankError.textContent =
            "Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin t√†i kho·∫£n ng√¢n h√†ng v√† ƒë·ªãa ch·ªâ nh·∫≠n h√†ng!";
          bankError.style.display = "block";
          return;
        }
        if (!/^\d+$/.test(bankAccount)) {
          bankError.textContent = "S·ªë t√†i kho·∫£n ch·ªâ ƒë∆∞·ª£c nh·∫≠p s·ªë!";
          bankError.style.display = "block";
          return;
        }
        bankError.style.display = "none";
        alert(
          `Thanh to√°n th√†nh c√¥ng!\nNg√¢n h√†ng: ${bankName}\nS·ªë t√†i kho·∫£n: ${bankAccount}\nCh·ªß t√†i kho·∫£n: ${bankOwner}\n N·ªôi dung chuy·ªÉn kho·∫£n: ƒê·ªãa ch·ªâ nh·∫≠n h√†ng c·ªßa b·∫°n ${shippingAddress}\nC·∫£m ∆°n b·∫°n ƒë√£ mua h√†ng.`
        );
        cart = [];
        closeCheckout();
        updateCart();
      }
      // G·∫Øn s·ª± ki·ªán cho n√∫t mua h√†ng sau khi render s·∫£n ph·∫©m
      setTimeout(() => {
        document.querySelectorAll(".buy-btn").forEach((btn, idx) => {
          btn.onclick = () => addToCart(idx);
        });
        document.querySelectorAll(".detail-btn").forEach((btn, idx) => {
          btn.onclick = () => openPopup(idx);
        });
      }, 100);

      // ƒê√°nh gi√° d·ªãch v·ª•
      let selectedStar = 5;
      const stars = document.querySelectorAll("#starRating .star");
      stars.forEach((star) => {
        star.addEventListener("mouseenter", function () {
          highlightStars(this.dataset.star);
        });
        star.addEventListener("mouseleave", function () {
          highlightStars(selectedStar);
        });
        star.addEventListener("click", function () {
          selectedStar = this.dataset.star;
          highlightStars(selectedStar);
        });
      });
      function highlightStars(starCount) {
        stars.forEach((star) => {
          star.style.color =
            star.dataset.star <= starCount ? "#ffb347" : "#ccc";
        });
      }
      highlightStars(selectedStar);

      document.getElementById("sendReviewBtn").onclick = function () {
        const text = document.getElementById("reviewText").value.trim();
        const msg = document.getElementById("reviewMsg");
        if (!selectedStar && !text) {
          msg.textContent = "Vui l√≤ng ch·ªçn s·ªë sao v√† nh·∫≠p nh·∫≠n x√©t!";
          msg.style.display = "block";
          return;
        }
        msg.style.display = "block";
        msg.style.color = "#28a745";
        msg.textContent = "C·∫£m ∆°n b·∫°n ƒë√£ ƒë√°nh gi√° d·ªãch v·ª•!";
        setTimeout(() => {
          msg.style.display = "none";
        }, 2500);
        document.getElementById("reviewText").value = "";
        selectedStar = 5;
        highlightStars(selectedStar);
      };
    </script>
  </body>
</html>
